<!DOCTYPE html>
<html lang="fr" data-bs-theme="light">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Paiement Factures - Budget App</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <!-- Custom Style (pour fixer le footer) -->
    <style>
        :root {
            --app-primary-color: #0d6efd;
        }

        body {
            padding-bottom: 70px;
            /* Espace pour le footer fixe */
            font-family: 'Inter', sans-serif;
        }

        .footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            z-index: 1030;
            background-color: var(--bs-body-bg);
            box-shadow: 0 -4px 10px rgba(0, 0, 0, 0.1);
            border-top: 1px solid var(--bs-border-color);
        }

        .service-card {
            border-radius: 12px;
            background-color: var(--bs-light);
            transition: all 0.2s;
        }

        .service-card:hover {
            box-shadow: 0 4px 10px rgba(13, 110, 253, 0.1);
            transform: translateY(-2px);
        }

        .alert-custom {
            opacity: 0;
            transition: opacity 0.5s, transform 0.5s;
            transform: translateY(-20px);
        }

        .alert-custom.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>

<body>
    <header class="bg-primary text-white p-3 text-center rounded-bottom-lg shadow-sm">
        <h2 class="mb-0 fs-4">Paiement Factures</h2>
    </header>

    <div class="container mt-4 mb-5 pb-5">

        <!-- Zone de Message Personnalisé -->
        <div id="messageAlert" class="alert-custom position-fixed top-0 start-50 translate-middle-x mt-3 w-75 rounded-3 shadow" style="z-index: 2000;">
            <!-- Le contenu sera rempli par JavaScript -->
        </div>

        <div class="card p-4 shadow-lg rounded-4">
            <h5 class="mb-4 text-primary fw-bold">Factures générales</h5>
            <form id="billPaymentForm">
                <div class="mb-3">
                    <!-- ID corrigé : TypeFacture -->
                    <label for="TypeFacture" class="form-label">Type Facture</label>
                    <select id="TypeFacture" class="form-select rounded-3">
                        <option>Électricité</option>
                        <option selected>Eau</option>
                        <option>Internet</option>
                        <option>Téléphone</option>
                        <option>Cinéma</option>
                    </select>
                </div>
                <div class="mb-4">
                    <!-- ID correct : montantInput -->
                    <label for="montantInput" class="form-label">Montant</label>
                    <input type="number" id="montantInput" class="form-control rounded-3" placeholder="Entrer le montant (Ex: 50.00)" required min="1" step="0.01" />
                </div>
                <button type="submit" class="btn btn-primary w-100 py-2 fw-bold rounded-3">Payer Facture</button>
            </form>
        </div>
    </div>

    <!-- MODAL DE CONFIRMATION (Remplace confirm()) -->
    <div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content rounded-4 shadow-lg">
                <div class="modal-header border-0 pb-0">
                    <h5 class="modal-title fw-bold" id="confirmationModalLabel">Confirmer le paiement</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body pt-2">
                    <p class="mb-1">Type de facture: <span id="modalBillType" class="fw-semibold text-primary"></span></p>
                    <p>Montant à payer: <span id="modalAmount" class="fw-bold text-danger"></span></p>
                    <hr>
                    <p class="mb-0">Êtes-vous sûr de vouloir **continuer** cette opération ?</p>
                </div>
                <div class="modal-footer border-0 pt-0">
                    <button type="button" class="btn btn-secondary rounded-3" data-bs-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btn-danger rounded-3" id="confirmPaymentBtn">Confirmer le Paiement</button>
                </div>
            </div>
        </div>
    </div>


    <!-- FOOTER -->
    <footer class="footer mt-5 py-3">
        <div class="d-flex justify-content-around">
            <a href="./home.html" class="text-decoration-none text-muted text-center"><i class="bi bi-house-door-fill fs-4"></i><br>Accueil</a>
            <a href="./bankhistory.html" class="text-decoration-none text-muted text-center"><i class="bi bi-clock-history fs-4"></i><br>Historique</a>
            <a href="./myqr.html" class="text-decoration-none text-muted text-center"><i class="bi bi-qr-code-scan fs-4"></i><br>Mon QR</a>
            <a href="./rewards.html" class="text-decoration-none text-muted text-center"><i class="bi bi-gift fs-4"></i><br>Récompenses</a>
            <a href="./profile.html" class="text-decoration-none text-muted text-center"><i class="bi bi-person fs-4"></i><br>Profile</a>
        </div>
    </footer>

    <!-- Bootstrap JS (Doit être chargé avant jQuery pour les composants comme Modal) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <!-- jQuery (Doit être chargé AVANT le script personnalisé qui utilise $) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script>
        // Fonction pour afficher le message personnalisé
        function showCustomAlert(message, type = 'success') {
            const alertElement = document.getElementById('messageAlert');
            alertElement.className = 'alert-custom position-fixed top-0 start-50 translate-middle-x mt-3 w-75 rounded-3 shadow alert alert-' + type;
            alertElement.innerHTML = `<div class="d-flex align-items-center"><i class="bi bi-${type === 'success' ? 'check-circle-fill' : 'x-octagon-fill'} me-2"></i> ${message}</div>`;

            // Afficher
            setTimeout(() => alertElement.classList.add('show'), 10);

            // Cacher après 4 secondes
            setTimeout(() => {
                alertElement.classList.remove('show');
                // Nettoyer après la transition
                setTimeout(() => alertElement.className = 'alert-custom', 500);
            }, 4000);
        }

        // pour gérer la soumission du formulaire et la confirmation
        $(document).ready(function() {
            let currentBillType = '';
            let currentAmount = '';
            const myModal = new bootstrap.Modal(document.getElementById('confirmationModal'));

            // Gérer la soumission du formulaire (Ouvre la modale)
            $('#billPaymentForm').on('submit', function(e) {
                e.preventDefault();

                // Récupération des valeurs corrigées
                currentBillType = $('#TypeFacture').val();
                currentAmount = $('#montantInput').val();

                // Remplir la modale avec les données
                $('#modalBillType').text(currentBillType);
                $('#modalAmount').text(currentAmount + ' €');

                // Afficher la modale de confirmation
                myModal.show();
            });

            // Gérer le clic sur le bouton "Confirmer le Paiement" dans la modale
            $('#confirmPaymentBtn').on('click', function() {
                myModal.hide(); // Fermer la modale

                // Logique de validation de l'opération
                if (currentBillType && currentAmount) {
                    // l'opération est réussie
                    showCustomAlert(`Paiement de ${currentAmount} € effectué pour la facture de type : ${currentBillType}.`, 'success');

                    // et la réinitialisation du formulaire si nécessaire.
                    $('#billPaymentForm')[0].reset(); // Réinitialise le formulaire
                } else {
                    showCustomAlert("Erreur : Les informations de paiement sont incomplètes.", 'danger');
                }
            });

            // Gérer l'annulation via le bouton "Annuler" ou le "x" de la modale (Bootstrap)
            document.getElementById('confirmationModal').addEventListener('hidden.bs.modal', function(event) {
                // Si la modale est cachée sans confirmation (par exemple en cliquant sur annuler ou le fond)

            })

        });
    </script>
</body>

</html>