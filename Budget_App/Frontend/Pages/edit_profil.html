<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Modifier le Profil - Budget App</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" />
    <link rel="stylesheet" href="../css/style.css" />

</head>

<body>
    <header class="d-flex align-items-center bg-white p-2 border-bottom">
        <a href="./setting.html"><i class="bi bi-chevron-left fs-4"></i></a>
        <h5 class="ms-4 mb-0 fw-bold">Information de Profil</h5>
    </header>
    <div class="container-fluid p-3">
        <div class="text-center mb-4">
            <img src="./images/profil.jpg" alt="Profile" class="rounded-circle small-profile-img mb-2" width="100" height="100">
            <a href="#" class="d-block text-primary"><i class="bi bi-camera me-1"></i> Changer la photo</a>
        </div>

        <form>
            <div class="mb-3">
                <label for="fullName" class="form-label">Nom complet</label>
                <input type="text" class="form-control" id="fullName" value="Themesflat Dupont">
            </div>
            <div class="mb-3">
                <label for="email" class="form-label">Email</label>
                <input type="email" class="form-control" id="email" value="themesflat@budgetapp.com">
            </div>
            <div class="mb-3">
                <label for="phone" class="form-label">Numéro de téléphone</label>
                <input type="tel" class="form-control" id="phone" value="+33 6 12 34 56 78">
            </div>
            <div class="mb-3">
                <label for="address" class="form-label">Adresse</label>
                <input type="text" class="form-control" id="address" value="12 Rue de la Finance">
            </div>
            <div class="mb-3">
                <label for="postcode" class="form-label">Code postal</label>
                <input type="number" class="form-control" id="postcode" value="44000">
            </div>
            <div class="mb-3">
                <label for="ville" class="form-label">Ville</label>
                <input type="text" class="form-control" id="ville" value="Nantes">
            </div>

            <button type="submit" class="btn btn-primary w-100 btn-lg mt-4">Sauvegarder les changements</button>
        </form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        const fullName = document.getElementById("fullName");
        const email = document.getElementById("email");
        const phone = document.getElementById("phone");
        const address = document.getElementById("address");
        const postcode = document.getElementById("postcode");
        const ville = document.getElementById("ville");
        document.querySelector('#btnUpdate').addEventListener('click', async (e) => {
            e.preventDefault(); // empêche le rechargement du formulaire
            // Envoie des données au serveur
            const formData = new FormData();
            formData.append('fullName', fullName.value);
            formData.append('email', email.value);
            formData.append('phone', phone.value);
            formData.append('address', address.value);
            formData.append('postcode', postcode.value);
            formData.append('ville', ville.value);
            formData.append('user_id', localStorage.getItem("user_id")); // si l'id stocké en localStorage

            const response = await fetch("../backend/update_profile.php", {
                method: "POST",
                body: formData //
            });

            const result = await response.json();

            if (result.status === "success") {
                alert("Profil mis à jour !");
            } else {
                alert("Erreur : " + result.message);
            }
        });
    </script>

</body>

</html>